<!DOCTYPE html>
<html xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" layout:decorate="~{layout}">

<head>
    <title layout:fragment="title">myParty | View RSVP</title>
    <script src='https://api.mapbox.com/mapbox-gl-js/v2.3.1/mapbox-gl.js'></script>
    <link href='https://api.mapbox.com/mapbox-gl-js/v2.3.1/mapbox-gl.css' rel='stylesheet' />
</head>

<section layout:fragment="content">

    <!--Show The Party Info-->
    <div>
        <div th:text="${party.location.addressOne} + ', ' + ${party.location.city} + ', ' + ${party.location.state} + ', ' + ${party.location.zipcode}"
             id="fullAddress" th:value="${party.location.addressOne} + ', ' + ${party.location.city} + ', ' + ${party.location.state} + ', ' + ${party.location.zipcode}">
        </div>
    </div>

    <div id='map' style='width: 25%; height: 40vh'></div>

    <script src="/keys.js"></script>
    <script src="/js/jquery.js"></script>
    <script src="/js/mapbox-geocoder-utils.js"></script>

    <!--Start of JS-->
    <script>
        const address = $("#fullAddress").html();

        geocode(address, mapboxApiKey).then(function (result) {
            mapboxgl.accessToken = mapboxApiKey;

            var map = new mapboxgl.Map({
                container: 'map',
                style: 'mapbox://styles/mapbox/streets-v9',
                zoom: 15,
                center: (result)
             });

            var marker = new mapboxgl.Marker({
                draggable: true
            }).setLngLat(result).addTo(map);

        });
    </script>

</section>
<footer><p layout:fragment="custom-footer">This is actually working</p></footer>
</html>